I"<p>SQL In Excel</p>

<h2 id="excel-ä¸­æ­£ç¡®ä½¿ç”¨sqlçš„å§¿åŠ¿">Excel ä¸­æ­£ç¡®ä½¿ç”¨SQLçš„å§¿åŠ¿</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sub DoSql_Execute1()
    Dim cnn As Object, rst As Object
    Dim Mypath As String, Str_cnn As String, Sql As String
    Dim i As Long

    Set cnn = CreateObject("adodb.connection")
    'ä»¥ä¸Šæ˜¯ç¬¬ä¸€æ­¥ï¼ŒåæœŸç»‘å®šADO

    Mypath = ThisWorkbook.FullName

    If Application.Version &lt; 12 Then
        Str_cnn = "Provider=Microsoft.jet.OLEDB.4.0;Extended Properties=Excel 8.0;Data Source=" &amp; Mypath
    Else
        Str_cnn = "Provider=Microsoft.ACE.OLEDB.12.0;Extended Properties=Excel 12.0;Data Source=" &amp; Mypath
    End If

    cnn.Open Str_cnn
    'ä»¥ä¸Šæ˜¯ç¬¬äºŒæ­¥ï¼Œå»ºç«‹é“¾æ¥


    Sql = "SELECT å§“å,æˆç»© FROM [Sheet1$] WHERE æˆç»©&gt;=80"
    'Sqlè¯­å¥ï¼ŒæŸ¥è¯¢Sheet1è¡¨æˆç»©å¤§äº80â€¦â€¦å§“åå’Œæˆç»©çš„è®°å½•

    Set rst = cnn.Execute(Sql)
    'cnn.Execute()æ‰§è¡ŒSQLè¯­å¥ï¼Œå§‹ç»ˆå¾—åˆ°ä¸€ä¸ªæ–°çš„è®°å½•é›†rst
    'ä»¥ä¸Šæ˜¯ç¬¬ä¸‰æ­¥ï¼Œç¼–å†™å¹¶ä½¿ç”¨SQLè¯­å¥


    [d:e].ClearContents
    'æ¸…ç©º[d:e]åŒºåŸŸçš„å€¼

    For i = 0 To rst.Fields.Count - 1
    'åˆ©ç”¨fieldså±æ€§è·å–æ‰€æœ‰å­—æ®µåï¼ŒfieldsåŒ…å«äº†å½“å‰è®°å½•æœ‰å…³çš„æ‰€æœ‰å­—æ®µ,fields.countå¾—åˆ°å­—æ®µçš„æ•°é‡
    'ç”±äºFields.Countä¸‹æ ‡ä¸º0ï¼Œåˆä»0å¼€å§‹éå†ï¼Œå› æ­¤æ€»æ•°-1

        Cells(1, i + 4) = rst.Fields(i).Name
    Next

    Range("d2").CopyFromRecordset rst
    'ä½¿ç”¨å•å…ƒæ ¼å¯¹è±¡çš„CopyFromRecordsetæ–¹æ³•å°†rstå†…å®¹å¤åˆ¶åˆ°D2å•å…ƒæ ¼ä¸ºå·¦ä¸Šè§’çš„å•å…ƒæ ¼åŒºåŸŸ
    'ä»¥ä¸Šæ˜¯ç¬¬å››æ­¥ï¼Œå°†SQLæŸ¥è¯¢ç»“æœå’Œå­—æ®µåå†™å…¥è¡¨æ ¼æŒ‡å®šåŒºåŸŸ

    cnn.Close
    'å…³é—­é“¾æ¥

    Set cnn = Nothing
    'é‡Šæ”¾å†…å­˜

End Sub

</code></pre></div></div>

<p><a href="é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Zm4di93kNKhOs8HsLNk1Vg">ç¤ºä¾‹æ–‡ä»¶ä¸‹è½½åœ°å€</a>
æå–ç ï¼š15qz</p>

<hr />

<h2 id="adoå¸¸ç”¨è¿æ¥å­—ç¬¦ä¸²">ADOå¸¸ç”¨è¿æ¥å­—ç¬¦ä¸²</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>âˆã€€ Accessæ•°æ®åº“

æ²¡æœ‰å¯†ç ä¿æŠ¤çš„Accessæ•°æ®åº“

Provider=Microsoft.ACE.OLEDB.12.0;Data Source=å¸¦è·¯å¾„çš„Accessæ•°æ®åº“åç§°;

æœ‰å¯†ç ä¿æŠ¤çš„Accessæ•°æ®åº“

Provider=Microsoft.ACE.OLEDB.12.0;Data Source=å¸¦è·¯å¾„çš„Accessæ•°æ®åº“å®Œæ•´åç§°;JetOLEDB:Database Password=å¯†ç ;

âˆã€€ Textæ–‡ä»¶

Provider=Microsoft.ACE.OLEDB.12.0; Data Source=æ–‡æœ¬æ–‡ä»¶è·¯å¾„&amp;'\';Extended Properties=â€™text;HDR=Yes;FMT=Delimiedâ€™;

âˆã€€ SQL Serveræ•°æ®åº“

Provider =SQLOLEDB;Password=å¯†ç ;User ID= ç”¨æˆ·å; Data Source =SQLæ•°æ®åº“æœåŠ¡å™¨åç§°;Initial Catalog=æ•°æ®åº“åç§°;

âˆã€€ Oracle æ•°æ®åº“

Provider =madaora; PassWord=å¯†ç ; User ID=ç”¨æˆ·å; Data Source =Oracleæ•°æ®åº“æœåŠ¡å™¨åç§°;

âˆã€€ FoxProæ•°æ®åº“

Provide=Microsoft.ACE.OLEDB.12.0;User ID=ç”¨æˆ·å;Data Source=dbfæ–‡ä»¶è·¯å¾„;Extended Properties=dBASEIV;

âˆã€€ Excelå·¥ä½œç°¿

03ç‰ˆæœ¬Excel

Provider=Microsoft.jet.OLEDB.4.0;Extended Properties=â€™Excel 8.0;HDR=yes;IMEX=0â€™;Data Source=å¸¦è·¯å¾„çš„Excelå·¥ä½œç°¿å®Œæ•´åç§°

07~16ç‰ˆæœ¬Excel

Provider=Microsoft.ACE.OLEDB.12.0;Extended Properties=â€™Excel 12.0; HDR=yes;IMEX=0â€™;Data Source=å¸¦è·¯å¾„çš„Excelå·¥ä½œç°¿å®Œæ•´åç§°

</code></pre></div></div>

<hr />

<h2 id="æµ‹è¯•é“¾æ¥æ˜¯å¦æˆåŠŸ">æµ‹è¯•é“¾æ¥æ˜¯å¦æˆåŠŸ</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sub test()
    Dim cnn As Object
    Set cnn = CreateObject("adodb.connection")
    cnn.Open "provider=microsoft.ace.oledb.12.0;extended properties=excel 12.0;data source=" &amp; ThisWorkbook.FullName
    If cnn.State = 1 Then
        MsgBox "è¿æ¥æˆåŠŸ!" &amp; vbCrLf &amp; "ADOç‰ˆæœ¬ä¸ºï¼š" &amp; cnn.Version &amp; vbCrLf &amp; "Connectionå¯¹è±¡æä¾›è€…åç§°ï¼š" &amp; cnn.provider
        cnn.Close
        Set cnn = Nothing
    Else
        MsgBox "æ•°æ®åº“è¿æ¥å¤±è´¥"
    End If
End Sub


</code></pre></div></div>

<blockquote>
  <p>Stateå±æ€§è¿”å›Connectionå¯¹è±¡çš„çŠ¶æ€ï¼›0æ˜¯AdStateClosedï¼Œè¡¨ç¤ºå¯¹è±¡æ˜¯å…³é—­çš„ï¼›1æ˜¯AdStateOpenï¼Œè¡¨ç¤ºå¯¹è±¡æ˜¯æ‰“å¼€çš„ï¼›2æ˜¯AdStateConnectingï¼Œè¡¨ç¤ºå¯¹è±¡æ­£åœ¨è¿æ¥ç­‰ã€‚</p>
</blockquote>

<p>Versionå±æ€§åªè¯»ï¼Œè¿”å›Connectionå¯¹è±¡çš„ç‰ˆæœ¬å·ï¼›Provideræ˜¯Connectionå¯¹è±¡è¿æ¥æ•°æ®åº“æä¾›ç¨‹åºè€…çš„åç§°ï¼Œå½“Connectionå¯¹è±¡å…³é—­æ—¶ï¼Œè¯¥å±æ€§å¯è¯»å†™ï¼›å¦åˆ™ä¸ºåªè¯»ã€‚</p>

<hr />

<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzODI3ODk1Mw==&amp;mid=100000003&amp;idx=2&amp;sn=1bce514549a940fd0c68a5deecd99180&amp;chksm=7adb6c454dace553434f269529da28870d0047c3f890670dd97d0ebf1bc90cb5351cedd26799&amp;mpshare=1&amp;scene=1&amp;srcid=1012La8yRMpc60NXGwIuMr4f#rd">ä»£ç æ¥è‡ªExcel VBA+ADO+SQLå…¥é—¨æ•™ç¨‹</a></p>
:ET